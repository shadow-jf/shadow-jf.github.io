{"version":3,"sources":["webpack://webpack-web/./node_modules/_konva@8.3.10@konva/lib/Node.js"],"names":[],"mappings":"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","file":"js/384c6018ca7.js","sourcesContent":["import { Util, Transform } from './Util.js';\nimport { Factory } from './Factory.js';\nimport { SceneCanvas, HitCanvas } from './Canvas.js';\nimport { Konva } from './Global.js';\nimport { DD } from './DragAndDrop.js';\nimport { getNumberValidator, getStringValidator, getBooleanValidator, } from './Validators.js';\nvar ABSOLUTE_OPACITY = 'absoluteOpacity', ALL_LISTENERS = 'allEventListeners', ABSOLUTE_TRANSFORM = 'absoluteTransform', ABSOLUTE_SCALE = 'absoluteScale', CANVAS = 'canvas', CHANGE = 'Change', CHILDREN = 'children', KONVA = 'konva', LISTENING = 'listening', MOUSEENTER = 'mouseenter', MOUSELEAVE = 'mouseleave', NAME = 'name', SET = 'set', SHAPE = 'Shape', SPACE = ' ', STAGE = 'stage', TRANSFORM = 'transform', UPPER_STAGE = 'Stage', VISIBLE = 'visible', TRANSFORM_CHANGE_STR = [\n    'xChange.konva',\n    'yChange.konva',\n    'scaleXChange.konva',\n    'scaleYChange.konva',\n    'skewXChange.konva',\n    'skewYChange.konva',\n    'rotationChange.konva',\n    'offsetXChange.konva',\n    'offsetYChange.konva',\n    'transformsEnabledChange.konva',\n].join(SPACE);\nlet idCounter = 1;\nexport class Node {\n    constructor(config) {\n        this._id = idCounter++;\n        this.eventListeners = {};\n        this.attrs = {};\n        this.index = 0;\n        this._allEventListeners = null;\n        this.parent = null;\n        this._cache = new Map();\n        this._attachedDepsListeners = new Map();\n        this._lastPos = null;\n        this._batchingTransformChange = false;\n        this._needClearTransformCache = false;\n        this._filterUpToDate = false;\n        this._isUnderCache = false;\n        this._dragEventId = null;\n        this._shouldFireChangeEvents = false;\n        this.setAttrs(config);\n        this._shouldFireChangeEvents = true;\n    }\n    hasChildren() {\n        return false;\n    }\n    _clearCache(attr) {\n        if ((attr === TRANSFORM || attr === ABSOLUTE_TRANSFORM) &&\n            this._cache.get(attr)) {\n            this._cache.get(attr).dirty = true;\n        }\n        else if (attr) {\n            this._cache.delete(attr);\n        }\n        else {\n            this._cache.clear();\n        }\n    }\n    _getCache(attr, privateGetter) {\n        var cache = this._cache.get(attr);\n        var isTransform = attr === TRANSFORM || attr === ABSOLUTE_TRANSFORM;\n        var invalid = cache === undefined || (isTransform && cache.dirty === true);\n        if (invalid) {\n            cache = privateGetter.call(this);\n            this._cache.set(attr, cache);\n        }\n        return cache;\n    }\n    _calculate(name, deps, getter) {\n        if (!this._attachedDepsListeners.get(name)) {\n            const depsString = deps.map((dep) => dep + 'Change.konva').join(SPACE);\n            this.on(depsString, () => {\n                this._clearCache(name);\n            });\n            this._attachedDepsListeners.set(name, true);\n        }\n        return this._getCache(name, getter);\n    }\n    _getCanvasCache() {\n        return this._cache.get(CANVAS);\n    }\n    _clearSelfAndDescendantCache(attr) {\n        this._clearCache(attr);\n        if (attr === ABSOLUTE_TRANSFORM) {\n            this.fire('absoluteTransformChange');\n        }\n    }\n    clearCache() {\n        this._cache.delete(CANVAS);\n        this._clearSelfAndDescendantCache();\n        this._requestDraw();\n        return this;\n    }\n    cache(config) {\n        var conf = config || {};\n        var rect = {};\n        if (conf.x === undefined ||\n            conf.y === undefined ||\n            conf.width === undefined ||\n            conf.height === undefined) {\n            rect = this.getClientRect({\n                skipTransform: true,\n                relativeTo: this.getParent(),\n            });\n        }\n        var width = Math.ceil(conf.width || rect.width), height = Math.ceil(conf.height || rect.height), pixelRatio = conf.pixelRatio, x = conf.x === undefined ? Math.floor(rect.x) : conf.x, y = conf.y === undefined ? Math.floor(rect.y) : conf.y, offset = conf.offset || 0, drawBorder = conf.drawBorder || false, hitCanvasPixelRatio = conf.hitCanvasPixelRatio || 1;\n        if (!width || !height) {\n            Util.error('Can not cache the node. Width or height of the node equals 0. Caching is skipped.');\n            return;\n        }\n        width += offset * 2 + 1;\n        height += offset * 2 + 1;\n        x -= offset;\n        y -= offset;\n        var cachedSceneCanvas = new SceneCanvas({\n            pixelRatio: pixelRatio,\n            width: width,\n            height: height,\n        }), cachedFilterCanvas = new SceneCanvas({\n            pixelRatio: pixelRatio,\n            width: 0,\n            height: 0,\n        }), cachedHitCanvas = new HitCanvas({\n            pixelRatio: hitCanvasPixelRatio,\n            width: width,\n            height: height,\n        }), sceneContext = cachedSceneCanvas.getContext(), hitContext = cachedHitCanvas.getContext();\n        cachedHitCanvas.isCache = true;\n        cachedSceneCanvas.isCache = true;\n        this._cache.delete(CANVAS);\n        this._filterUpToDate = false;\n        if (conf.imageSmoothingEnabled === false) {\n            cachedSceneCanvas.getContext()._context.imageSmoothingEnabled = false;\n            cachedFilterCanvas.getContext()._context.imageSmoothingEnabled = false;\n        }\n        sceneContext.save();\n        hitContext.save();\n        sceneContext.translate(-x, -y);\n        hitContext.translate(-x, -y);\n        this._isUnderCache = true;\n        this._clearSelfAndDescendantCache(ABSOLUTE_OPACITY);\n        this._clearSelfAndDescendantCache(ABSOLUTE_SCALE);\n        this.drawScene(cachedSceneCanvas, this);\n        this.drawHit(cachedHitCanvas, this);\n        this._isUnderCache = false;\n        sceneContext.restore();\n        hitContext.restore();\n        if (drawBorder) {\n            sceneContext.save();\n            sceneContext.beginPath();\n            sceneContext.rect(0, 0, width, height);\n            sceneContext.closePath();\n            sceneContext.setAttr('strokeStyle', 'red');\n            sceneContext.setAttr('lineWidth', 5);\n            sceneContext.stroke();\n            sceneContext.restore();\n        }\n        this._cache.set(CANVAS, {\n            scene: cachedSceneCanvas,\n            filter: cachedFilterCanvas,\n            hit: cachedHitCanvas,\n            x: x,\n            y: y,\n        });\n        this._requestDraw();\n        return this;\n    }\n    isCached() {\n        return this._cache.has(CANVAS);\n    }\n    getClientRect(config) {\n        throw new Error('abstract \"getClientRect\" method call');\n    }\n    _transformedRect(rect, top) {\n        var points = [\n            { x: rect.x, y: rect.y },\n            { x: rect.x + rect.width, y: rect.y },\n            { x: rect.x + rect.width, y: rect.y + rect.height },\n            { x: rect.x, y: rect.y + rect.height },\n        ];\n        var minX, minY, maxX, maxY;\n        var trans = this.getAbsoluteTransform(top);\n        points.forEach(function (point) {\n            var transformed = trans.point(point);\n            if (minX === undefined) {\n                minX = maxX = transformed.x;\n                minY = maxY = transformed.y;\n            }\n            minX = Math.min(minX, transformed.x);\n            minY = Math.min(minY, transformed.y);\n            maxX = Math.max(maxX, transformed.x);\n            maxY = Math.max(maxY, transformed.y);\n        });\n        return {\n            x: minX,\n            y: minY,\n            width: maxX - minX,\n            height: maxY - minY,\n        };\n    }\n    _drawCachedSceneCanvas(context) {\n        context.save();\n        context._applyOpacity(this);\n        context._applyGlobalCompositeOperation(this);\n        const canvasCache = this._getCanvasCache();\n        context.translate(canvasCache.x, canvasCache.y);\n        var cacheCanvas = this._getCachedSceneCanvas();\n        var ratio = cacheCanvas.pixelRatio;\n        context.drawImage(cacheCanvas._canvas, 0, 0, cacheCanvas.width / ratio, cacheCanvas.height / ratio);\n        context.restore();\n    }\n    _drawCachedHitCanvas(context) {\n        var canvasCache = this._getCanvasCache(), hitCanvas = canvasCache.hit;\n        context.save();\n        context.translate(canvasCache.x, canvasCache.y);\n        context.drawImage(hitCanvas._canvas, 0, 0, hitCanvas.width / hitCanvas.pixelRatio, hitCanvas.height / hitCanvas.pixelRatio);\n        context.restore();\n    }\n    _getCachedSceneCanvas() {\n        var filters = this.filters(), cachedCanvas = this._getCanvasCache(), sceneCanvas = cachedCanvas.scene, filterCanvas = cachedCanvas.filter, filterContext = filterCanvas.getContext(), len, imageData, n, filter;\n        if (filters) {\n            if (!this._filterUpToDate) {\n                var ratio = sceneCanvas.pixelRatio;\n                filterCanvas.setSize(sceneCanvas.width / sceneCanvas.pixelRatio, sceneCanvas.height / sceneCanvas.pixelRatio);\n                try {\n                    len = filters.length;\n                    filterContext.clear();\n                    filterContext.drawImage(sceneCanvas._canvas, 0, 0, sceneCanvas.getWidth() / ratio, sceneCanvas.getHeight() / ratio);\n                    imageData = filterContext.getImageData(0, 0, filterCanvas.getWidth(), filterCanvas.getHeight());\n                    for (n = 0; n < len; n++) {\n                        filter = filters[n];\n                        if (typeof filter !== 'function') {\n                            Util.error('Filter should be type of function, but got ' +\n                                typeof filter +\n                                ' instead. Please check correct filters');\n                            continue;\n                        }\n                        filter.call(this, imageData);\n                        filterContext.putImageData(imageData, 0, 0);\n                    }\n                }\n                catch (e) {\n                    Util.error('Unable to apply filter. ' +\n                        e.message +\n                        ' This post my help you https://konvajs.org/docs/posts/Tainted_Canvas.html.');\n                }\n                this._filterUpToDate = true;\n            }\n            return filterCanvas;\n        }\n        return sceneCanvas;\n    }\n    on(evtStr, handler) {\n        this._cache && this._cache.delete(ALL_LISTENERS);\n        if (arguments.length === 3) {\n            return this._delegate.apply(this, arguments);\n        }\n        var events = evtStr.split(SPACE), len = events.length, n, event, parts, baseEvent, name;\n        for (n = 0; n < len; n++) {\n            event = events[n];\n            parts = event.split('.');\n            baseEvent = parts[0];\n            name = parts[1] || '';\n            if (!this.eventListeners[baseEvent]) {\n                this.eventListeners[baseEvent] = [];\n            }\n            this.eventListeners[baseEvent].push({\n                name: name,\n                handler: handler,\n            });\n        }\n        return this;\n    }\n    off(evtStr, callback) {\n        var events = (evtStr || '').split(SPACE), len = events.length, n, t, event, parts, baseEvent, name;\n        this._cache && this._cache.delete(ALL_LISTENERS);\n        if (!evtStr) {\n            for (t in this.eventListeners) {\n                this._off(t);\n            }\n        }\n        for (n = 0; n < len; n++) {\n            event = events[n];\n            parts = event.split('.');\n            baseEvent = parts[0];\n            name = parts[1];\n            if (baseEvent) {\n                if (this.eventListeners[baseEvent]) {\n                    this._off(baseEvent, name, callback);\n                }\n            }\n            else {\n                for (t in this.eventListeners) {\n                    this._off(t, name, callback);\n                }\n            }\n        }\n        return this;\n    }\n    dispatchEvent(evt) {\n        var e = {\n            target: this,\n            type: evt.type,\n            evt: evt,\n        };\n        this.fire(evt.type, e);\n        return this;\n    }\n    addEventListener(type, handler) {\n        this.on(type, function (evt) {\n            handler.call(this, evt.evt);\n        });\n        return this;\n    }\n    removeEventListener(type) {\n        this.off(type);\n        return this;\n    }\n    _delegate(event, selector, handler) {\n        var stopNode = this;\n        this.on(event, function (evt) {\n            var targets = evt.target.findAncestors(selector, true, stopNode);\n            for (var i = 0; i < targets.length; i++) {\n                evt = Util.cloneObject(evt);\n                evt.currentTarget = targets[i];\n                handler.call(targets[i], evt);\n            }\n        });\n    }\n    remove() {\n        if (this.isDragging()) {\n            this.stopDrag();\n        }\n        DD._dragElements.delete(this._id);\n        this._remove();\n        return this;\n    }\n    _clearCaches() {\n        this._clearSelfAndDescendantCache(ABSOLUTE_TRANSFORM);\n        this._clearSelfAndDescendantCache(ABSOLUTE_OPACITY);\n        this._clearSelfAndDescendantCache(ABSOLUTE_SCALE);\n        this._clearSelfAndDescendantCache(STAGE);\n        this._clearSelfAndDescendantCache(VISIBLE);\n        this._clearSelfAndDescendantCache(LISTENING);\n    }\n    _remove() {\n        this._clearCaches();\n        var parent = this.getParent();\n        if (parent && parent.children) {\n            parent.children.splice(this.index, 1);\n            parent._setChildrenIndices();\n            this.parent = null;\n        }\n    }\n    destroy() {\n        this.remove();\n        return this;\n    }\n    getAttr(attr) {\n        var method = 'get' + Util._capitalize(attr);\n        if (Util._isFunction(this[method])) {\n            return this[method]();\n        }\n        return this.attrs[attr];\n    }\n    getAncestors() {\n        var parent = this.getParent(), ancestors = [];\n        while (parent) {\n            ancestors.push(parent);\n            parent = parent.getParent();\n        }\n        return ancestors;\n    }\n    getAttrs() {\n        return this.attrs || {};\n    }\n    setAttrs(config) {\n        this._batchTransformChanges(() => {\n            var key, method;\n            if (!config) {\n                return this;\n            }\n            for (key in config) {\n                if (key === CHILDREN) {\n                    continue;\n                }\n                method = SET + Util._capitalize(key);\n                if (Util._isFunction(this[method])) {\n                    this[method](config[key]);\n                }\n                else {\n                    this._setAttr(key, config[key]);\n                }\n            }\n        });\n        return this;\n    }\n    isListening() {\n        return this._getCache(LISTENING, this._isListening);\n    }\n    _isListening(relativeTo) {\n        const listening = this.listening();\n        if (!listening) {\n            return false;\n        }\n        const parent = this.getParent();\n        if (parent && parent !== relativeTo && this !== relativeTo) {\n            return parent._isListening(relativeTo);\n        }\n        else {\n            return true;\n        }\n    }\n    isVisible() {\n        return this._getCache(VISIBLE, this._isVisible);\n    }\n    _isVisible(relativeTo) {\n        const visible = this.visible();\n        if (!visible) {\n            return false;\n        }\n        const parent = this.getParent();\n        if (parent && parent !== relativeTo && this !== relativeTo) {\n            return parent._isVisible(relativeTo);\n        }\n        else {\n            return true;\n        }\n    }\n    shouldDrawHit(top, skipDragCheck = false) {\n        if (top) {\n            return this._isVisible(top) && this._isListening(top);\n        }\n        var layer = this.getLayer();\n        var layerUnderDrag = false;\n        DD._dragElements.forEach((elem) => {\n            if (elem.dragStatus !== 'dragging') {\n                return;\n            }\n            else if (elem.node.nodeType === 'Stage') {\n                layerUnderDrag = true;\n            }\n            else if (elem.node.getLayer() === layer) {\n                layerUnderDrag = true;\n            }\n        });\n        var dragSkip = !skipDragCheck && !Konva.hitOnDragEnabled && layerUnderDrag;\n        return this.isListening() && this.isVisible() && !dragSkip;\n    }\n    show() {\n        this.visible(true);\n        return this;\n    }\n    hide() {\n        this.visible(false);\n        return this;\n    }\n    getZIndex() {\n        return this.index || 0;\n    }\n    getAbsoluteZIndex() {\n        var depth = this.getDepth(), that = this, index = 0, nodes, len, n, child;\n        function addChildren(children) {\n            nodes = [];\n            len = children.length;\n            for (n = 0; n < len; n++) {\n                child = children[n];\n                index++;\n                if (child.nodeType !== SHAPE) {\n                    nodes = nodes.concat(child.getChildren().slice());\n                }\n                if (child._id === that._id) {\n                    n = len;\n                }\n            }\n            if (nodes.length > 0 && nodes[0].getDepth() <= depth) {\n                addChildren(nodes);\n            }\n        }\n        if (that.nodeType !== UPPER_STAGE) {\n            addChildren(that.getStage().getChildren());\n        }\n        return index;\n    }\n    getDepth() {\n        var depth = 0, parent = this.parent;\n        while (parent) {\n            depth++;\n            parent = parent.parent;\n        }\n        return depth;\n    }\n    _batchTransformChanges(func) {\n        this._batchingTransformChange = true;\n        func();\n        this._batchingTransformChange = false;\n        if (this._needClearTransformCache) {\n            this._clearCache(TRANSFORM);\n            this._clearSelfAndDescendantCache(ABSOLUTE_TRANSFORM);\n        }\n        this._needClearTransformCache = false;\n    }\n    setPosition(pos) {\n        this._batchTransformChanges(() => {\n            this.x(pos.x);\n            this.y(pos.y);\n        });\n        return this;\n    }\n    getPosition() {\n        return {\n            x: this.x(),\n            y: this.y(),\n        };\n    }\n    getRelativePointerPosition() {\n        if (!this.getStage()) {\n            return null;\n        }\n        var pos = this.getStage().getPointerPosition();\n        if (!pos) {\n            return null;\n        }\n        var transform = this.getAbsoluteTransform().copy();\n        transform.invert();\n        return transform.point(pos);\n    }\n    getAbsolutePosition(top) {\n        let haveCachedParent = false;\n        let parent = this.parent;\n        while (parent) {\n            if (parent.isCached()) {\n                haveCachedParent = true;\n                break;\n            }\n            parent = parent.parent;\n        }\n        if (haveCachedParent && !top) {\n            top = true;\n        }\n        var absoluteMatrix = this.getAbsoluteTransform(top).getMatrix(), absoluteTransform = new Transform(), offset = this.offset();\n        absoluteTransform.m = absoluteMatrix.slice();\n        absoluteTransform.translate(offset.x, offset.y);\n        return absoluteTransform.getTranslation();\n    }\n    setAbsolutePosition(pos) {\n        var origTrans = this._clearTransform();\n        this.attrs.x = origTrans.x;\n        this.attrs.y = origTrans.y;\n        delete origTrans.x;\n        delete origTrans.y;\n        this._clearCache(TRANSFORM);\n        var it = this._getAbsoluteTransform().copy();\n        it.invert();\n        it.translate(pos.x, pos.y);\n        pos = {\n            x: this.attrs.x + it.getTranslation().x,\n            y: this.attrs.y + it.getTranslation().y,\n        };\n        this._setTransform(origTrans);\n        this.setPosition({ x: pos.x, y: pos.y });\n        this._clearCache(TRANSFORM);\n        this._clearSelfAndDescendantCache(ABSOLUTE_TRANSFORM);\n        return this;\n    }\n    _setTransform(trans) {\n        var key;\n        for (key in trans) {\n            this.attrs[key] = trans[key];\n        }\n    }\n    _clearTransform() {\n        var trans = {\n            x: this.x(),\n            y: this.y(),\n            rotation: this.rotation(),\n            scaleX: this.scaleX(),\n            scaleY: this.scaleY(),\n            offsetX: this.offsetX(),\n            offsetY: this.offsetY(),\n            skewX: this.skewX(),\n            skewY: this.skewY(),\n        };\n        this.attrs.x = 0;\n        this.attrs.y = 0;\n        this.attrs.rotation = 0;\n        this.attrs.scaleX = 1;\n        this.attrs.scaleY = 1;\n        this.attrs.offsetX = 0;\n        this.attrs.offsetY = 0;\n        this.attrs.skewX = 0;\n        this.attrs.skewY = 0;\n        return trans;\n    }\n    move(change) {\n        var changeX = change.x, changeY = change.y, x = this.x(), y = this.y();\n        if (changeX !== undefined) {\n            x += changeX;\n        }\n        if (changeY !== undefined) {\n            y += changeY;\n        }\n        this.setPosition({ x: x, y: y });\n        return this;\n    }\n    _eachAncestorReverse(func, top) {\n        var family = [], parent = this.getParent(), len, n;\n        if (top && top._id === this._id) {\n            return;\n        }\n        family.unshift(this);\n        while (parent && (!top || parent._id !== top._id)) {\n            family.unshift(parent);\n            parent = parent.parent;\n        }\n        len = family.length;\n        for (n = 0; n < len; n++) {\n            func(family[n]);\n        }\n    }\n    rotate(theta) {\n        this.rotation(this.rotation() + theta);\n        return this;\n    }\n    moveToTop() {\n        if (!this.parent) {\n            Util.warn('Node has no parent. moveToTop function is ignored.');\n            return false;\n        }\n        var index = this.index, len = this.parent.getChildren().length;\n        if (index < len - 1) {\n            this.parent.children.splice(index, 1);\n            this.parent.children.push(this);\n            this.parent._setChildrenIndices();\n            return true;\n        }\n        return false;\n    }\n    moveUp() {\n        if (!this.parent) {\n            Util.warn('Node has no parent. moveUp function is ignored.');\n            return false;\n        }\n        var index = this.index, len = this.parent.getChildren().length;\n        if (index < len - 1) {\n            this.parent.children.splice(index, 1);\n            this.parent.children.splice(index + 1, 0, this);\n            this.parent._setChildrenIndices();\n            return true;\n        }\n        return false;\n    }\n    moveDown() {\n        if (!this.parent) {\n            Util.warn('Node has no parent. moveDown function is ignored.');\n            return false;\n        }\n        var index = this.index;\n        if (index > 0) {\n            this.parent.children.splice(index, 1);\n            this.parent.children.splice(index - 1, 0, this);\n            this.parent._setChildrenIndices();\n            return true;\n        }\n        return false;\n    }\n    moveToBottom() {\n        if (!this.parent) {\n            Util.warn('Node has no parent. moveToBottom function is ignored.');\n            return false;\n        }\n        var index = this.index;\n        if (index > 0) {\n            this.parent.children.splice(index, 1);\n            this.parent.children.unshift(this);\n            this.parent._setChildrenIndices();\n            return true;\n        }\n        return false;\n    }\n    setZIndex(zIndex) {\n        if (!this.parent) {\n            Util.warn('Node has no parent. zIndex parameter is ignored.');\n            return this;\n        }\n        if (zIndex < 0 || zIndex >= this.parent.children.length) {\n            Util.warn('Unexpected value ' +\n                zIndex +\n                ' for zIndex property. zIndex is just index of a node in children of its parent. Expected value is from 0 to ' +\n                (this.parent.children.length - 1) +\n                '.');\n        }\n        var index = this.index;\n        this.parent.children.splice(index, 1);\n        this.parent.children.splice(zIndex, 0, this);\n        this.parent._setChildrenIndices();\n        return this;\n    }\n    getAbsoluteOpacity() {\n        return this._getCache(ABSOLUTE_OPACITY, this._getAbsoluteOpacity);\n    }\n    _getAbsoluteOpacity() {\n        var absOpacity = this.opacity();\n        var parent = this.getParent();\n        if (parent && !parent._isUnderCache) {\n            absOpacity *= parent.getAbsoluteOpacity();\n        }\n        return absOpacity;\n    }\n    moveTo(newContainer) {\n        if (this.getParent() !== newContainer) {\n            this._remove();\n            newContainer.add(this);\n        }\n        return this;\n    }\n    toObject() {\n        var obj = {}, attrs = this.getAttrs(), key, val, getter, defaultValue, nonPlainObject;\n        obj.attrs = {};\n        for (key in attrs) {\n            val = attrs[key];\n            nonPlainObject =\n                Util.isObject(val) && !Util._isPlainObject(val) && !Util._isArray(val);\n            if (nonPlainObject) {\n                continue;\n            }\n            getter = typeof this[key] === 'function' && this[key];\n            delete attrs[key];\n            defaultValue = getter ? getter.call(this) : null;\n            attrs[key] = val;\n            if (defaultValue !== val) {\n                obj.attrs[key] = val;\n            }\n        }\n        obj.className = this.getClassName();\n        return Util._prepareToStringify(obj);\n    }\n    toJSON() {\n        return JSON.stringify(this.toObject());\n    }\n    getParent() {\n        return this.parent;\n    }\n    findAncestors(selector, includeSelf, stopNode) {\n        var res = [];\n        if (includeSelf && this._isMatch(selector)) {\n            res.push(this);\n        }\n        var ancestor = this.parent;\n        while (ancestor) {\n            if (ancestor === stopNode) {\n                return res;\n            }\n            if (ancestor._isMatch(selector)) {\n                res.push(ancestor);\n            }\n            ancestor = ancestor.parent;\n        }\n        return res;\n    }\n    isAncestorOf(node) {\n        return false;\n    }\n    findAncestor(selector, includeSelf, stopNode) {\n        return this.findAncestors(selector, includeSelf, stopNode)[0];\n    }\n    _isMatch(selector) {\n        if (!selector) {\n            return false;\n        }\n        if (typeof selector === 'function') {\n            return selector(this);\n        }\n        var selectorArr = selector.replace(/ /g, '').split(','), len = selectorArr.length, n, sel;\n        for (n = 0; n < len; n++) {\n            sel = selectorArr[n];\n            if (!Util.isValidSelector(sel)) {\n                Util.warn('Selector \"' +\n                    sel +\n                    '\" is invalid. Allowed selectors examples are \"#foo\", \".bar\" or \"Group\".');\n                Util.warn('If you have a custom shape with such className, please change it to start with upper letter like \"Triangle\".');\n                Util.warn('Konva is awesome, right?');\n            }\n            if (sel.charAt(0) === '#') {\n                if (this.id() === sel.slice(1)) {\n                    return true;\n                }\n            }\n            else if (sel.charAt(0) === '.') {\n                if (this.hasName(sel.slice(1))) {\n                    return true;\n                }\n            }\n            else if (this.className === sel || this.nodeType === sel) {\n                return true;\n            }\n        }\n        return false;\n    }\n    getLayer() {\n        var parent = this.getParent();\n        return parent ? parent.getLayer() : null;\n    }\n    getStage() {\n        return this._getCache(STAGE, this._getStage);\n    }\n    _getStage() {\n        var parent = this.getParent();\n        if (parent) {\n            return parent.getStage();\n        }\n        else {\n            return undefined;\n        }\n    }\n    fire(eventType, evt = {}, bubble) {\n        evt.target = evt.target || this;\n        if (bubble) {\n            this._fireAndBubble(eventType, evt);\n        }\n        else {\n            this._fire(eventType, evt);\n        }\n        return this;\n    }\n    getAbsoluteTransform(top) {\n        if (top) {\n            return this._getAbsoluteTransform(top);\n        }\n        else {\n            return this._getCache(ABSOLUTE_TRANSFORM, this._getAbsoluteTransform);\n        }\n    }\n    _getAbsoluteTransform(top) {\n        var at;\n        if (top) {\n            at = new Transform();\n            this._eachAncestorReverse(function (node) {\n                var transformsEnabled = node.transformsEnabled();\n                if (transformsEnabled === 'all') {\n                    at.multiply(node.getTransform());\n                }\n                else if (transformsEnabled === 'position') {\n                    at.translate(node.x() - node.offsetX(), node.y() - node.offsetY());\n                }\n            }, top);\n            return at;\n        }\n        else {\n            at = this._cache.get(ABSOLUTE_TRANSFORM) || new Transform();\n            if (this.parent) {\n                this.parent.getAbsoluteTransform().copyInto(at);\n            }\n            else {\n                at.reset();\n            }\n            var transformsEnabled = this.transformsEnabled();\n            if (transformsEnabled === 'all') {\n                at.multiply(this.getTransform());\n            }\n            else if (transformsEnabled === 'position') {\n                const x = this.attrs.x || 0;\n                const y = this.attrs.y || 0;\n                const offsetX = this.attrs.offsetX || 0;\n                const offsetY = this.attrs.offsetY || 0;\n                at.translate(x - offsetX, y - offsetY);\n            }\n            at.dirty = false;\n            return at;\n        }\n    }\n    getAbsoluteScale(top) {\n        var parent = this;\n        while (parent) {\n            if (parent._isUnderCache) {\n                top = parent;\n            }\n            parent = parent.getParent();\n        }\n        const transform = this.getAbsoluteTransform(top);\n        const attrs = transform.decompose();\n        return {\n            x: attrs.scaleX,\n            y: attrs.scaleY,\n        };\n    }\n    getAbsoluteRotation() {\n        return this.getAbsoluteTransform().decompose().rotation;\n    }\n    getTransform() {\n        return this._getCache(TRANSFORM, this._getTransform);\n    }\n    _getTransform() {\n        var _a, _b;\n        var m = this._cache.get(TRANSFORM) || new Transform();\n        m.reset();\n        var x = this.x(), y = this.y(), rotation = Konva.getAngle(this.rotation()), scaleX = (_a = this.attrs.scaleX) !== null && _a !== void 0 ? _a : 1, scaleY = (_b = this.attrs.scaleY) !== null && _b !== void 0 ? _b : 1, skewX = this.attrs.skewX || 0, skewY = this.attrs.skewY || 0, offsetX = this.attrs.offsetX || 0, offsetY = this.attrs.offsetY || 0;\n        if (x !== 0 || y !== 0) {\n            m.translate(x, y);\n        }\n        if (rotation !== 0) {\n            m.rotate(rotation);\n        }\n        if (skewX !== 0 || skewY !== 0) {\n            m.skew(skewX, skewY);\n        }\n        if (scaleX !== 1 || scaleY !== 1) {\n            m.scale(scaleX, scaleY);\n        }\n        if (offsetX !== 0 || offsetY !== 0) {\n            m.translate(-1 * offsetX, -1 * offsetY);\n        }\n        m.dirty = false;\n        return m;\n    }\n    clone(obj) {\n        var attrs = Util.cloneObject(this.attrs), key, allListeners, len, n, listener;\n        for (key in obj) {\n            attrs[key] = obj[key];\n        }\n        var node = new this.constructor(attrs);\n        for (key in this.eventListeners) {\n            allListeners = this.eventListeners[key];\n            len = allListeners.length;\n            for (n = 0; n < len; n++) {\n                listener = allListeners[n];\n                if (listener.name.indexOf(KONVA) < 0) {\n                    if (!node.eventListeners[key]) {\n                        node.eventListeners[key] = [];\n                    }\n                    node.eventListeners[key].push(listener);\n                }\n            }\n        }\n        return node;\n    }\n    _toKonvaCanvas(config) {\n        config = config || {};\n        var box = this.getClientRect();\n        var stage = this.getStage(), x = config.x !== undefined ? config.x : Math.floor(box.x), y = config.y !== undefined ? config.y : Math.floor(box.y), pixelRatio = config.pixelRatio || 1, canvas = new SceneCanvas({\n            width: config.width || Math.ceil(box.width) || (stage ? stage.width() : 0),\n            height: config.height ||\n                Math.ceil(box.height) ||\n                (stage ? stage.height() : 0),\n            pixelRatio: pixelRatio,\n        }), context = canvas.getContext();\n        if (config.imageSmoothingEnabled === false) {\n            context._context.imageSmoothingEnabled = false;\n        }\n        context.save();\n        if (x || y) {\n            context.translate(-1 * x, -1 * y);\n        }\n        this.drawScene(canvas);\n        context.restore();\n        return canvas;\n    }\n    toCanvas(config) {\n        return this._toKonvaCanvas(config)._canvas;\n    }\n    toDataURL(config) {\n        config = config || {};\n        var mimeType = config.mimeType || null, quality = config.quality || null;\n        var url = this._toKonvaCanvas(config).toDataURL(mimeType, quality);\n        if (config.callback) {\n            config.callback(url);\n        }\n        return url;\n    }\n    toImage(config) {\n        if (!config || !config.callback) {\n            throw 'callback required for toImage method config argument';\n        }\n        var callback = config.callback;\n        delete config.callback;\n        Util._urlToImage(this.toDataURL(config), function (img) {\n            callback(img);\n        });\n    }\n    setSize(size) {\n        this.width(size.width);\n        this.height(size.height);\n        return this;\n    }\n    getSize() {\n        return {\n            width: this.width(),\n            height: this.height(),\n        };\n    }\n    getClassName() {\n        return this.className || this.nodeType;\n    }\n    getType() {\n        return this.nodeType;\n    }\n    getDragDistance() {\n        if (this.attrs.dragDistance !== undefined) {\n            return this.attrs.dragDistance;\n        }\n        else if (this.parent) {\n            return this.parent.getDragDistance();\n        }\n        else {\n            return Konva.dragDistance;\n        }\n    }\n    _off(type, name, callback) {\n        var evtListeners = this.eventListeners[type], i, evtName, handler;\n        for (i = 0; i < evtListeners.length; i++) {\n            evtName = evtListeners[i].name;\n            handler = evtListeners[i].handler;\n            if ((evtName !== 'konva' || name === 'konva') &&\n                (!name || evtName === name) &&\n                (!callback || callback === handler)) {\n                evtListeners.splice(i, 1);\n                if (evtListeners.length === 0) {\n                    delete this.eventListeners[type];\n                    break;\n                }\n                i--;\n            }\n        }\n    }\n    _fireChangeEvent(attr, oldVal, newVal) {\n        this._fire(attr + CHANGE, {\n            oldVal: oldVal,\n            newVal: newVal,\n        });\n    }\n    addName(name) {\n        if (!this.hasName(name)) {\n            var oldName = this.name();\n            var newName = oldName ? oldName + ' ' + name : name;\n            this.name(newName);\n        }\n        return this;\n    }\n    hasName(name) {\n        if (!name) {\n            return false;\n        }\n        const fullName = this.name();\n        if (!fullName) {\n            return false;\n        }\n        var names = (fullName || '').split(/\\s/g);\n        return names.indexOf(name) !== -1;\n    }\n    removeName(name) {\n        var names = (this.name() || '').split(/\\s/g);\n        var index = names.indexOf(name);\n        if (index !== -1) {\n            names.splice(index, 1);\n            this.name(names.join(' '));\n        }\n        return this;\n    }\n    setAttr(attr, val) {\n        var func = this[SET + Util._capitalize(attr)];\n        if (Util._isFunction(func)) {\n            func.call(this, val);\n        }\n        else {\n            this._setAttr(attr, val);\n        }\n        return this;\n    }\n    _requestDraw() {\n        if (Konva.autoDrawEnabled) {\n            const drawNode = this.getLayer() || this.getStage();\n            drawNode === null || drawNode === void 0 ? void 0 : drawNode.batchDraw();\n        }\n    }\n    _setAttr(key, val) {\n        var oldVal = this.attrs[key];\n        if (oldVal === val && !Util.isObject(val)) {\n            return;\n        }\n        if (val === undefined || val === null) {\n            delete this.attrs[key];\n        }\n        else {\n            this.attrs[key] = val;\n        }\n        if (this._shouldFireChangeEvents) {\n            this._fireChangeEvent(key, oldVal, val);\n        }\n        this._requestDraw();\n    }\n    _setComponentAttr(key, component, val) {\n        var oldVal;\n        if (val !== undefined) {\n            oldVal = this.attrs[key];\n            if (!oldVal) {\n                this.attrs[key] = this.getAttr(key);\n            }\n            this.attrs[key][component] = val;\n            this._fireChangeEvent(key, oldVal, val);\n        }\n    }\n    _fireAndBubble(eventType, evt, compareShape) {\n        if (evt && this.nodeType === SHAPE) {\n            evt.target = this;\n        }\n        var shouldStop = (eventType === MOUSEENTER || eventType === MOUSELEAVE) &&\n            ((compareShape &&\n                (this === compareShape ||\n                    (this.isAncestorOf && this.isAncestorOf(compareShape)))) ||\n                (this.nodeType === 'Stage' && !compareShape));\n        if (!shouldStop) {\n            this._fire(eventType, evt);\n            var stopBubble = (eventType === MOUSEENTER || eventType === MOUSELEAVE) &&\n                compareShape &&\n                compareShape.isAncestorOf &&\n                compareShape.isAncestorOf(this) &&\n                !compareShape.isAncestorOf(this.parent);\n            if (((evt && !evt.cancelBubble) || !evt) &&\n                this.parent &&\n                this.parent.isListening() &&\n                !stopBubble) {\n                if (compareShape && compareShape.parent) {\n                    this._fireAndBubble.call(this.parent, eventType, evt, compareShape);\n                }\n                else {\n                    this._fireAndBubble.call(this.parent, eventType, evt);\n                }\n            }\n        }\n    }\n    _getProtoListeners(eventType) {\n        let listeners = this._cache.get(ALL_LISTENERS);\n        if (!listeners) {\n            listeners = {};\n            let obj = Object.getPrototypeOf(this);\n            while (obj) {\n                if (!obj.eventListeners) {\n                    obj = Object.getPrototypeOf(obj);\n                    continue;\n                }\n                for (var event in obj.eventListeners) {\n                    const newEvents = obj.eventListeners[event];\n                    const oldEvents = listeners[event] || [];\n                    listeners[event] = newEvents.concat(oldEvents);\n                }\n                obj = Object.getPrototypeOf(obj);\n            }\n            this._cache.set(ALL_LISTENERS, listeners);\n        }\n        return listeners[eventType];\n    }\n    _fire(eventType, evt) {\n        evt = evt || {};\n        evt.currentTarget = this;\n        evt.type = eventType;\n        const topListeners = this._getProtoListeners(eventType);\n        if (topListeners) {\n            for (var i = 0; i < topListeners.length; i++) {\n                topListeners[i].handler.call(this, evt);\n            }\n        }\n        const selfListeners = this.eventListeners[eventType];\n        if (selfListeners) {\n            for (var i = 0; i < selfListeners.length; i++) {\n                selfListeners[i].handler.call(this, evt);\n            }\n        }\n    }\n    draw() {\n        this.drawScene();\n        this.drawHit();\n        return this;\n    }\n    _createDragElement(evt) {\n        var pointerId = evt ? evt.pointerId : undefined;\n        var stage = this.getStage();\n        var ap = this.getAbsolutePosition();\n        var pos = stage._getPointerById(pointerId) ||\n            stage._changedPointerPositions[0] ||\n            ap;\n        DD._dragElements.set(this._id, {\n            node: this,\n            startPointerPos: pos,\n            offset: {\n                x: pos.x - ap.x,\n                y: pos.y - ap.y,\n            },\n            dragStatus: 'ready',\n            pointerId,\n        });\n    }\n    startDrag(evt, bubbleEvent = true) {\n        if (!DD._dragElements.has(this._id)) {\n            this._createDragElement(evt);\n        }\n        const elem = DD._dragElements.get(this._id);\n        elem.dragStatus = 'dragging';\n        this.fire('dragstart', {\n            type: 'dragstart',\n            target: this,\n            evt: evt && evt.evt,\n        }, bubbleEvent);\n    }\n    _setDragPosition(evt, elem) {\n        const pos = this.getStage()._getPointerById(elem.pointerId);\n        if (!pos) {\n            return;\n        }\n        var newNodePos = {\n            x: pos.x - elem.offset.x,\n            y: pos.y - elem.offset.y,\n        };\n        var dbf = this.dragBoundFunc();\n        if (dbf !== undefined) {\n            const bounded = dbf.call(this, newNodePos, evt);\n            if (!bounded) {\n                Util.warn('dragBoundFunc did not return any value. That is unexpected behavior. You must return new absolute position from dragBoundFunc.');\n            }\n            else {\n                newNodePos = bounded;\n            }\n        }\n        if (!this._lastPos ||\n            this._lastPos.x !== newNodePos.x ||\n            this._lastPos.y !== newNodePos.y) {\n            this.setAbsolutePosition(newNodePos);\n            this._requestDraw();\n        }\n        this._lastPos = newNodePos;\n    }\n    stopDrag(evt) {\n        const elem = DD._dragElements.get(this._id);\n        if (elem) {\n            elem.dragStatus = 'stopped';\n        }\n        DD._endDragBefore(evt);\n        DD._endDragAfter(evt);\n    }\n    setDraggable(draggable) {\n        this._setAttr('draggable', draggable);\n        this._dragChange();\n    }\n    isDragging() {\n        const elem = DD._dragElements.get(this._id);\n        return elem ? elem.dragStatus === 'dragging' : false;\n    }\n    _listenDrag() {\n        this._dragCleanup();\n        this.on('mousedown.konva touchstart.konva', function (evt) {\n            var shouldCheckButton = evt.evt['button'] !== undefined;\n            var canDrag = !shouldCheckButton || Konva.dragButtons.indexOf(evt.evt['button']) >= 0;\n            if (!canDrag) {\n                return;\n            }\n            if (this.isDragging()) {\n                return;\n            }\n            var hasDraggingChild = false;\n            DD._dragElements.forEach((elem) => {\n                if (this.isAncestorOf(elem.node)) {\n                    hasDraggingChild = true;\n                }\n            });\n            if (!hasDraggingChild) {\n                this._createDragElement(evt);\n            }\n        });\n    }\n    _dragChange() {\n        if (this.attrs.draggable) {\n            this._listenDrag();\n        }\n        else {\n            this._dragCleanup();\n            var stage = this.getStage();\n            if (!stage) {\n                return;\n            }\n            const dragElement = DD._dragElements.get(this._id);\n            const isDragging = dragElement && dragElement.dragStatus === 'dragging';\n            const isReady = dragElement && dragElement.dragStatus === 'ready';\n            if (isDragging) {\n                this.stopDrag();\n            }\n            else if (isReady) {\n                DD._dragElements.delete(this._id);\n            }\n        }\n    }\n    _dragCleanup() {\n        this.off('mousedown.konva');\n        this.off('touchstart.konva');\n    }\n    isClientRectOnScreen(margin = { x: 0, y: 0 }) {\n        const stage = this.getStage();\n        if (!stage) {\n            return false;\n        }\n        const screenRect = {\n            x: -margin.x,\n            y: -margin.y,\n            width: stage.width() + 2 * margin.x,\n            height: stage.height() + 2 * margin.y,\n        };\n        return Util.haveIntersection(screenRect, this.getClientRect());\n    }\n    static create(data, container) {\n        if (Util._isString(data)) {\n            data = JSON.parse(data);\n        }\n        return this._createNode(data, container);\n    }\n    static _createNode(obj, container) {\n        var className = Node.prototype.getClassName.call(obj), children = obj.children, no, len, n;\n        if (container) {\n            obj.attrs.container = container;\n        }\n        if (!Konva[className]) {\n            Util.warn('Can not find a node with class name \"' +\n                className +\n                '\". Fallback to \"Shape\".');\n            className = 'Shape';\n        }\n        const Class = Konva[className];\n        no = new Class(obj.attrs);\n        if (children) {\n            len = children.length;\n            for (n = 0; n < len; n++) {\n                no.add(Node._createNode(children[n]));\n            }\n        }\n        return no;\n    }\n}\nNode.prototype.nodeType = 'Node';\nNode.prototype._attrsAffectingSize = [];\nNode.prototype.eventListeners = {};\nNode.prototype.on.call(Node.prototype, TRANSFORM_CHANGE_STR, function () {\n    if (this._batchingTransformChange) {\n        this._needClearTransformCache = true;\n        return;\n    }\n    this._clearCache(TRANSFORM);\n    this._clearSelfAndDescendantCache(ABSOLUTE_TRANSFORM);\n});\nNode.prototype.on.call(Node.prototype, 'visibleChange.konva', function () {\n    this._clearSelfAndDescendantCache(VISIBLE);\n});\nNode.prototype.on.call(Node.prototype, 'listeningChange.konva', function () {\n    this._clearSelfAndDescendantCache(LISTENING);\n});\nNode.prototype.on.call(Node.prototype, 'opacityChange.konva', function () {\n    this._clearSelfAndDescendantCache(ABSOLUTE_OPACITY);\n});\nconst addGetterSetter = Factory.addGetterSetter;\naddGetterSetter(Node, 'zIndex');\naddGetterSetter(Node, 'absolutePosition');\naddGetterSetter(Node, 'position');\naddGetterSetter(Node, 'x', 0, getNumberValidator());\naddGetterSetter(Node, 'y', 0, getNumberValidator());\naddGetterSetter(Node, 'globalCompositeOperation', 'source-over', getStringValidator());\naddGetterSetter(Node, 'opacity', 1, getNumberValidator());\naddGetterSetter(Node, 'name', '', getStringValidator());\naddGetterSetter(Node, 'id', '', getStringValidator());\naddGetterSetter(Node, 'rotation', 0, getNumberValidator());\nFactory.addComponentsGetterSetter(Node, 'scale', ['x', 'y']);\naddGetterSetter(Node, 'scaleX', 1, getNumberValidator());\naddGetterSetter(Node, 'scaleY', 1, getNumberValidator());\nFactory.addComponentsGetterSetter(Node, 'skew', ['x', 'y']);\naddGetterSetter(Node, 'skewX', 0, getNumberValidator());\naddGetterSetter(Node, 'skewY', 0, getNumberValidator());\nFactory.addComponentsGetterSetter(Node, 'offset', ['x', 'y']);\naddGetterSetter(Node, 'offsetX', 0, getNumberValidator());\naddGetterSetter(Node, 'offsetY', 0, getNumberValidator());\naddGetterSetter(Node, 'dragDistance', null, getNumberValidator());\naddGetterSetter(Node, 'width', 0, getNumberValidator());\naddGetterSetter(Node, 'height', 0, getNumberValidator());\naddGetterSetter(Node, 'listening', true, getBooleanValidator());\naddGetterSetter(Node, 'preventDefault', true, getBooleanValidator());\naddGetterSetter(Node, 'filters', null, function (val) {\n    this._filterUpToDate = false;\n    return val;\n});\naddGetterSetter(Node, 'visible', true, getBooleanValidator());\naddGetterSetter(Node, 'transformsEnabled', 'all', getStringValidator());\naddGetterSetter(Node, 'size');\naddGetterSetter(Node, 'dragBoundFunc');\naddGetterSetter(Node, 'draggable', false, getBooleanValidator());\nFactory.backCompat(Node, {\n    rotateDeg: 'rotate',\n    setRotationDeg: 'setRotation',\n    getRotationDeg: 'getRotation',\n});\n"],"sourceRoot":""}